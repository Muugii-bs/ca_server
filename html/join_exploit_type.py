from bs4 import BeautifulSoup as bs 
import mysql.connector as db
import re
import os
import sys
import json

db_config = {
		'host':		'127.0.0.1',
		'port':		3306,
		'user':		'root',
		'password':	'root',
		'database':	'cnl',
		'autocommit':   True,
}
conn = db.connect(**db_config)
cursor = conn.cursor()
conn1 = db.connect(**db_config)
cursor1 = conn1.cursor()

def set_type():
    sql = """SELECT t2.cve_id, t1.type 
             FROM vuln_exploit_fetched t1 
             INNER JOIN vuln_exploits t2 
             ON t1.exploit_db_id=t2.exploit_db_id
             WHERE t2.use_flag = 1"""
    cursor.execute(sql)
    for row in cursor:
        sql = 'UPDATE vuln_analyze SET exploit_type=%s WHERE entry_id=%s'
        cursor1.execute(sql, (row[1], row[0]))

if __name__ == '__main__':
    set_type()
    cursor.close()
    cursor1.close()
    conn.close()
    conn1.close()
